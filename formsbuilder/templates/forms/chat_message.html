{% comment %} chat_message.html {% endcomment %}

<div class="mb-4 text-right opacity-0 translate-y-4 scale-95 transition-all duration-500 ease-out">
    <div class="inline-block bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-2xl rounded-tr-md max-w-xs shadow-lg relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"></div>
        <div class="relative">{{ qa.question }}</div>
    </div>
</div>

<!-- Typing indicator -->
<div class="typing-indicator mb-4 opacity-0 transition-opacity duration-300">
    <div class="flex items-center gap-2 text-gray-500">
        <div class="w-8 h-8 bg-gradient-to-br from-red-400 to-red-500 rounded-full flex items-center justify-center">
            <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12,2A2,2 0 0,1 14,4C14,5.1 13.1,6 12,6C10.9,6 10,5.1 10,4A2,2 0 0,1 12,2ZM10.5,7H13.5C14.06,7 14.5,7.44 14.5,8V8.29C14.5,8.65 14.35,8.96 14.11,9.19L13,10.29V21.5C13,21.78 12.78,22 12.5,22H11.5C11.22,22 11,21.78 11,21.5V10.29L9.89,9.19C9.65,8.96 9.5,8.65 9.5,8.29V8C9.5,7.44 9.94,7 10.5,7Z"/>
            </svg>
        </div>
        <div class="flex gap-1">
            <div class="w-2 h-2 bg-red-400 rounded-full animate-pulse"></div>
            <div class="w-2 h-2 bg-red-400 rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
            <div class="w-2 h-2 bg-red-400 rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
        </div>
    </div>
</div>

<div class="answer-bubble mb-4 opacity-0 translate-y-4 scale-95 transition-all duration-500 ease-out">
    <div class="inline-block bg-white border border-red-100 p-4 rounded-2xl rounded-tl-md max-w-xs shadow-sm relative overflow-hidden">
        <div class="absolute top-0 right-0 w-12 h-12 bg-gradient-to-bl from-red-100/30 to-transparent rounded-full -translate-y-6 translate-x-6"></div>
        <div class="relative text-gray-700">{{ qa.answer }}</div>
    </div>
</div>

<script>
    // Enhanced animation sequence
    const currentScript = document.currentScript;
    const questionBubble = currentScript.previousElementSibling.previousElementSibling.previousElementSibling;
    const typingIndicator = currentScript.previousElementSibling.previousElementSibling;
    const answerBubble = currentScript.previousElementSibling;
    
    // Animate question immediately
    setTimeout(() => {
        questionBubble.classList.remove('opacity-0', 'translate-y-4', 'scale-95');
    }, 50);
    
    // Show typing indicator after question appears
    setTimeout(() => {
        typingIndicator.classList.remove('opacity-0');
    }, 600);
    
    // Hide typing indicator and show answer
    setTimeout(() => {
        typingIndicator.style.display = 'none';
        answerBubble.classList.remove('opacity-0', 'translate-y-4', 'scale-95');
        
        // Scroll to bottom
        const chatArea = document.getElementById('chat-area');
        if (chatArea) {
            chatArea.scrollTop = chatArea.scrollHeight;
        }
    }, 1500);
</script>